import{r as y,a as J,k as Y,m as Z,n as i,o as s,w as u,E as c,f as h,b,e as l,p as x,i as F,A,y as m,c as w,F as g,J as S,t as ee}from"./index-CTVkQrMm.js";import{P as le}from"./PageContainer-2AeyfqXh.js";import{g as ae}from"./globalConfig-BTq4CtJP.js";import{J as M}from"./jsoneditor-rjmmijB1.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"rules"},re={class:"card-header"},te={class:"card-header"},se={class:"modern-dialog-body"},de={class:"form-section"},ne={class:"form-section"},ie={class:"rule-types",style:{display:"flex","align-items":"center",gap:"8px"}},me={class:"form-section form-section-fields"},ve={class:"dialog-footer-modern"},fe={class:"modern-dialog-body"},pe={key:0,class:"form-section form-section-fields"},_e={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ce={class:"dialog-footer-modern"},be={__name:"Rules",setup(Ve){const $=[{label:"domain",value:"domain"},{label:"domain_suffix",value:"domain_suffix"},{label:"domain_keyword",value:"domain_keyword"},{label:"ip_cidr",value:"ip_cidr"},{label:"port",value:"port"},{label:"port_range",value:"port_range"},{label:"source_port",value:"source_port"},{label:"source_port_range",value:"source_port_range"},{label:"process_name",value:"process_name"},{label:"process_path",value:"process_path"},{label:"package_name",value:"package_name"},{label:"user",value:"user"},{label:"user_id",value:"user_id"},{label:"wifi_ssid",value:"wifi_ssid"},{label:"wifi_bssid",value:"wifi_bssid"},{label:"ip_version",value:"ip_version"},{label:"protocol",value:"protocol"},{label:"inbound",value:"inbound"},{label:"auth_user",value:"auth_user"},{label:"client",value:"client"},{label:"network",value:"network"},{label:"domain_regex",value:"domain_regex"},{label:"source_ip_cidr",value:"source_ip_cidr"},{label:"source_ip_is_private",value:"source_ip_is_private"},{label:"ip_is_private",value:"ip_is_private"},{label:"process_path_regex",value:"process_path_regex"},{label:"clash_mode",value:"clash_mode"},{label:"network_type",value:"network_type"},{label:"network_is_expensive",value:"network_is_expensive"},{label:"network_is_constrained",value:"network_is_constrained"},{label:"rule_set",value:"rule_set"},{label:"rule_set_ip_cidr_match_source",value:"rule_set_ip_cidr_match_source"},{label:"invert",value:"invert"}],T=y([]),a=J({visible:!1,isEdit:!1,form:{name:"",selectedTypes:[],rules:{}},rules:{}}),C=y([]),n=J({visible:!1,isEdit:!1,form:{type:"",tag:"",format:"",path:"",url:"",download_detour:"",update_interval:"",rules:[]}}),B=y([]),R=[{label:"query_type",value:"query_type",input:"textarea"},{label:"network",value:"network",input:"select",options:["tcp","udp"]},{label:"domain",value:"domain",input:"textarea"},{label:"domain_suffix",value:"domain_suffix",input:"textarea"},{label:"domain_keyword",value:"domain_keyword",input:"textarea"},{label:"domain_regex",value:"domain_regex",input:"textarea"},{label:"source_ip_cidr",value:"source_ip_cidr",input:"textarea"},{label:"ip_cidr",value:"ip_cidr",input:"textarea"},{label:"source_port",value:"source_port",input:"textarea"},{label:"source_port_range",value:"source_port_range",input:"textarea"},{label:"port",value:"port",input:"textarea"},{label:"port_range",value:"port_range",input:"textarea"},{label:"process_name",value:"process_name",input:"textarea"},{label:"process_path",value:"process_path",input:"textarea"},{label:"process_path_regex",value:"process_path_regex",input:"textarea"},{label:"package_name",value:"package_name",input:"textarea"},{label:"network_type",value:"network_type",input:"select",options:["wifi","cellular","ethernet","other"]},{label:"network_is_expensive",value:"network_is_expensive",input:"switch"},{label:"network_is_constrained",value:"network_is_constrained",input:"switch"},{label:"wifi_ssid",value:"wifi_ssid",input:"textarea"},{label:"wifi_bssid",value:"wifi_bssid",input:"textarea"},{label:"invert",value:"invert",input:"switch"}],j=y(null),z=async()=>{if(j.value)try{if(await j.value.validate(),!a.form.name||!a.form.selectedTypes.length){c.warning("请填写完整信息");return}const v={name:a.form.name,rules:{}};if(v.rules.action=a.form.rules.action,a.form.selectedTypes.forEach(o=>{const p=a.form.rules[o.value],k={};for(const[I,t]of Object.entries(p))t!==""&&t!==null&&t!==void 0&&(Array.isArray(t)&&t.length>0?k[I]=t:Array.isArray(t)||(k[I]=t));Object.keys(k).length>0&&(v.rules[o.value]=k)}),console.log("保存的规则数据:",v),a.isEdit){const o=T.value.findIndex(p=>p.name===a.form.name);o>-1&&(T.value[o]={...v,type:a.form.selectedTypes.map(p=>p.label).join(", "),content:JSON.stringify(v.rules,null,2)})}else{if(T.value.some(o=>o.name===a.form.name)){c.warning("已存在同名规则");return}T.value.push({...v,type:a.form.selectedTypes.map(o=>o.label).join(", "),content:JSON.stringify(v.rules,null,2)})}a.visible=!1,c.success(a.isEdit?"编辑成功":"添加成功")}catch(v){console.error("表单验证失败:",v),c.error("请填写必填项")}},W=()=>{if(!n.form.type||!n.form.tag){c.warning("请填写完整信息");return}if(n.form.type==="inline"&&n.form.rules.length===0){c.warning("请至少添加一条规则");return}if(n.form.type==="local"&&(!n.form.format||!n.form.path)){c.warning("请填写完整信息");return}if(n.form.type==="remote"&&(!n.form.format||!n.form.url)){c.warning("请填写完整信息");return}const v={...n.form};if(n.isEdit){const o=C.value.findIndex(p=>p.tag===n.form.tag);o>-1&&(C.value[o]=v)}else{if(C.value.some(o=>o.tag===n.form.tag)){c.warning("已存在同名规则集");return}C.value.push(v)}ae.route.rule_set=C.value,n.visible=!1,c.success(n.isEdit?"编辑成功":"添加成功")},L=()=>{n.form.rules.push({type:"",value:""})},G=v=>{n.form.rules.splice(v,1)};y(""),y("");const O=async()=>{try{console.log("开始获取规则...");const o=await(await fetch("/api/rules")).json();if(console.log("获取到的规则数据:",o),o.success){const p=o.rules||[];console.log("设置规则数据:",p),E.value&&E.value.set(p)}else c.error("获取规则失败："+o.error)}catch(v){console.error("获取规则出错:",v),c.error("获取规则失败："+v.message)}},N=async()=>{try{console.log("开始获取规则集...");const o=await(await fetch("/api/rule-sets")).json();if(console.log("获取到的规则集数据:",o),o.success){const p=o.rule_sets||[];console.log("设置规则集数据:",p),q.value&&q.value.set(p)}else c.error("获取规则集失败："+o.error)}catch(v){console.error("获取规则集出错:",v),c.error("获取规则集失败："+v.message)}},H=async()=>{try{const v=E.value.get(),p=await(await fetch("/api/rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rules:v})})).json();p.success?c.success("保存规则成功"):c.error("保存规则失败："+p.error)}catch(v){console.error("保存规则出错:",v),c.error("保存规则失败："+v.message)}},K=async()=>{try{const v=q.value.get(),p=await(await fetch("/api/rule-sets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rule_sets:v})})).json();p.success?c.success("保存规则集成功"):c.error("保存规则集失败："+p.error)}catch(v){console.error("保存规则集出错:",v),c.error("保存规则集失败："+v.message)}};Y(()=>{Q(),X(),setTimeout(()=>{O(),N()},100)});const E=y(null),q=y(null),Q=()=>{const v=document.getElementById("rulesEditor"),o={mode:"code",modes:["code","tree","view","form","text"],onError:function(p){c.error("JSON 格式错误："+p.toString())},mainMenuBar:!0,navigationBar:!1,statusBar:!0,colorPicker:!1,search:!0,format:!0,repair:!0};E.value=new M(v,o),O()},X=()=>{const v=document.getElementById("ruleSetsEditor"),o={mode:"code",modes:["code","tree","view","form","text"],onError:function(p){c.error("JSON 格式错误："+p.toString())},mainMenuBar:!0,navigationBar:!1,statusBar:!0,colorPicker:!1,search:!0,format:!0,repair:!0};q.value=new M(v,o),N()};return Z(()=>{E.value&&E.value.destroy(),q.value&&q.value.destroy()}),(v,o)=>{const p=h("el-icon"),k=h("el-button"),I=h("el-card"),t=h("el-option"),V=h("el-select"),d=h("el-form-item"),U=h("el-switch"),f=h("el-input"),P=h("el-form"),D=h("el-dialog");return s(),i(le,null,{default:u(()=>[b("div",ue,[o[33]||(o[33]=b("div",{class:"page-header"},[b("h2",{class:"page-title"},"规则配置")],-1)),l(I,{class:"box-card"},{header:u(()=>[b("div",re,[o[21]||(o[21]=b("span",null,"规则配置",-1)),l(k,{type:"primary",onClick:H},{default:u(()=>[l(p,null,{default:u(()=>[l(F(A))]),_:1}),o[20]||(o[20]=x(" 保存规则 "))]),_:1,__:[20]})])]),default:u(()=>[o[22]||(o[22]=b("div",{id:"rulesEditor",style:{width:"100%",height:"400px"}},null,-1))]),_:1,__:[22]}),l(I,{class:"box-card"},{header:u(()=>[b("div",te,[o[24]||(o[24]=b("span",null,"规则集配置",-1)),l(k,{type:"primary",onClick:K},{default:u(()=>[l(p,null,{default:u(()=>[l(F(A))]),_:1}),o[23]||(o[23]=x(" 保存规则集 "))]),_:1,__:[23]})])]),default:u(()=>[o[25]||(o[25]=b("div",{id:"ruleSetsEditor",style:{width:"100%",height:"400px"}},null,-1))]),_:1,__:[25]}),l(D,{modelValue:a.visible,"onUpdate:modelValue":o[9]||(o[9]=e=>a.visible=e),title:a.isEdit?"编辑规则":"添加规则",width:"600px",class:"modern-dialog"},{footer:u(()=>[b("div",ve,[l(k,{onClick:o[8]||(o[8]=e=>a.visible=!1)},{default:u(()=>o[27]||(o[27]=[x("取消")])),_:1,__:[27]}),l(k,{type:"primary",onClick:z},{default:u(()=>o[28]||(o[28]=[x("确定")])),_:1,__:[28]})])]),default:u(()=>[b("div",se,[l(P,{model:a.form,rules:a.rules,ref_key:"ruleFormRef",ref:j,"label-position":"top",class:"modern-form"},{default:u(()=>[b("div",de,[l(d,{label:"action",prop:"rules.action.action",required:""},{default:u(()=>[l(V,{modelValue:a.form.rules.action.action,"onUpdate:modelValue":o[0]||(o[0]=e=>a.form.rules.action.action=e),placeholder:"请选择action"},{default:u(()=>[l(t,{label:"route",value:"route"}),l(t,{label:"reject",value:"reject"}),l(t,{label:"hijack-dns",value:"hijack-dns"}),l(t,{label:"sniff",value:"sniff"})]),_:1},8,["modelValue"])]),_:1}),a.form.rules.action.action==="route"?(s(),i(d,{key:0,label:"outbound",prop:"rules.action.outbound",required:""},{default:u(()=>[l(V,{modelValue:a.form.rules.action.outbound,"onUpdate:modelValue":o[1]||(o[1]=e=>a.form.rules.action.outbound=e),placeholder:"请选择outbound"},{default:u(()=>[(s(!0),w(g,null,S(B.value,e=>(s(),i(t,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):m("",!0),a.form.rules.action.action==="reject"?(s(),w(g,{key:1},[l(d,{label:"method",prop:"rules.action.method",required:""},{default:u(()=>[l(V,{modelValue:a.form.rules.action.method,"onUpdate:modelValue":o[2]||(o[2]=e=>a.form.rules.action.method=e),placeholder:"请选择method"},{default:u(()=>[l(t,{label:"default",value:"default"}),l(t,{label:"drop",value:"drop"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"no_drop"},{default:u(()=>[l(U,{modelValue:a.form.rules.action.no_drop,"onUpdate:modelValue":o[3]||(o[3]=e=>a.form.rules.action.no_drop=e),"active-value":"true","inactive-value":"false"},null,8,["modelValue"])]),_:1})],64)):m("",!0),a.form.rules.action.action==="sniff"?(s(),w(g,{key:2},[l(d,{label:"sniffer"},{default:u(()=>[l(V,{modelValue:a.form.rules.action.sniffer,"onUpdate:modelValue":o[4]||(o[4]=e=>a.form.rules.action.sniffer=e),multiple:"",placeholder:"请选择sniffer"},{default:u(()=>[l(t,{label:"http",value:"http"}),l(t,{label:"tls",value:"tls"}),l(t,{label:"quic",value:"quic"}),l(t,{label:"stun",value:"stun"}),l(t,{label:"dns",value:"dns"}),l(t,{label:"bittorrent",value:"bittorrent"}),l(t,{label:"dtls",value:"dtls"}),l(t,{label:"ssh",value:"ssh"}),l(t,{label:"rdp",value:"rdp"}),l(t,{label:"ntp",value:"ntp"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"timeout"},{default:u(()=>[l(f,{modelValue:a.form.rules.action.timeout,"onUpdate:modelValue":o[5]||(o[5]=e=>a.form.rules.action.timeout=e),placeholder:"请输入timeout"},null,8,["modelValue"])]),_:1})],64)):m("",!0)]),b("div",ne,[l(d,{label:"规则类型",required:""},{default:u(()=>[b("div",ie,[l(V,{modelValue:a.form.selectedTypes,"onUpdate:modelValue":o[6]||(o[6]=e=>a.form.selectedTypes=e),multiple:"",placeholder:"请选择规则类型",style:{width:"320px"},"value-key":"value","collapse-tags":!1},{default:u(()=>[(s(),w(g,null,S($,e=>l(t,{key:e.value,label:e.label,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l(k,{type:"default",size:"small",onClick:o[7]||(o[7]=e=>a.form.selectedTypes=[])},{default:u(()=>o[26]||(o[26]=[x("清除")])),_:1,__:[26]})])]),_:1})]),b("div",me,[(s(!0),w(g,null,S(a.form.selectedTypes,e=>(s(),w(g,{key:e.value},[e.value==="domain"?(s(),i(d,{key:0,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].domains,"onUpdate:modelValue":r=>a.form.rules[e.value].domains=r,type:"textarea",rows:3,placeholder:"每行一个域名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="domain_suffix"?(s(),i(d,{key:1,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].domain_suffixes,"onUpdate:modelValue":r=>a.form.rules[e.value].domain_suffixes=r,type:"textarea",rows:3,placeholder:"每行一个域名后缀"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="domain_keyword"?(s(),i(d,{key:2,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].keywords,"onUpdate:modelValue":r=>a.form.rules[e.value].keywords=r,type:"textarea",rows:3,placeholder:"每行一个关键词"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="ip_cidr"?(s(),i(d,{key:3,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].ip_cidr,"onUpdate:modelValue":r=>a.form.rules[e.value].ip_cidr=r,type:"textarea",rows:3,placeholder:"每行一个IP CIDR"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="port"?(s(),i(d,{key:4,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].ports,"onUpdate:modelValue":r=>a.form.rules[e.value].ports=r,type:"textarea",rows:3,placeholder:"每行一个端口"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="port_range"?(s(),i(d,{key:5,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].port_ranges,"onUpdate:modelValue":r=>a.form.rules[e.value].port_ranges=r,type:"textarea",rows:3,placeholder:"每行一个端口范围，格式：起始端口-结束端口"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="source_port"?(s(),i(d,{key:6,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].ports,"onUpdate:modelValue":r=>a.form.rules[e.value].ports=r,type:"textarea",rows:3,placeholder:"每行一个源端口"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="source_port_range"?(s(),i(d,{key:7,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].port_ranges,"onUpdate:modelValue":r=>a.form.rules[e.value].port_ranges=r,type:"textarea",rows:3,placeholder:"每行一个源端口范围，格式：起始端口-结束端口"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="process_name"?(s(),i(d,{key:8,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].process_names,"onUpdate:modelValue":r=>a.form.rules[e.value].process_names=r,type:"textarea",rows:3,placeholder:"每行一个进程名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="process_path"?(s(),i(d,{key:9,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].process_paths,"onUpdate:modelValue":r=>a.form.rules[e.value].process_paths=r,type:"textarea",rows:3,placeholder:"每行一个进程路径"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="package_name"?(s(),i(d,{key:10,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].package_names,"onUpdate:modelValue":r=>a.form.rules[e.value].package_names=r,type:"textarea",rows:3,placeholder:"每行一个包名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="user"?(s(),i(d,{key:11,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].users,"onUpdate:modelValue":r=>a.form.rules[e.value].users=r,type:"textarea",rows:3,placeholder:"每行一个用户名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="user_id"?(s(),i(d,{key:12,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].user_ids,"onUpdate:modelValue":r=>a.form.rules[e.value].user_ids=r,type:"textarea",rows:3,placeholder:"每行一个用户ID"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="wifi_ssid"?(s(),i(d,{key:13,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].ssids,"onUpdate:modelValue":r=>a.form.rules[e.value].ssids=r,type:"textarea",rows:3,placeholder:"每行一个WIFI SSID"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="wifi_bssid"?(s(),i(d,{key:14,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].bssids,"onUpdate:modelValue":r=>a.form.rules[e.value].bssids=r,type:"textarea",rows:3,placeholder:"每行一个WIFI BSSID"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="ip_version"?(s(),i(d,{key:15,label:e.value},{default:u(()=>[l(V,{modelValue:a.form.rules[e.value].version,"onUpdate:modelValue":r=>a.form.rules[e.value].version=r,placeholder:"请选择IP版本"},{default:u(()=>[l(t,{label:"IPv4",value:"4"}),l(t,{label:"IPv6",value:"6"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="protocol"?(s(),i(d,{key:16,label:e.value},{default:u(()=>[l(V,{modelValue:a.form.rules[e.value].protocols,"onUpdate:modelValue":r=>a.form.rules[e.value].protocols=r,multiple:"",placeholder:"请选择protocol"},{default:u(()=>[l(t,{label:"http",value:"http"}),l(t,{label:"tls",value:"tls"}),l(t,{label:"quic",value:"quic"}),l(t,{label:"stun",value:"stun"}),l(t,{label:"dns",value:"dns"}),l(t,{label:"bittorrent",value:"bittorrent"}),l(t,{label:"dtls",value:"dtls"}),l(t,{label:"ssh",value:"ssh"}),l(t,{label:"rdp",value:"rdp"}),l(t,{label:"ntp",value:"ntp"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="inbound"?(s(),i(d,{key:17,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].inbound,"onUpdate:modelValue":r=>a.form.rules[e.value].inbound=r,type:"textarea",rows:3,placeholder:"每行一个inbound"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="auth_user"?(s(),i(d,{key:18,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].auth_user,"onUpdate:modelValue":r=>a.form.rules[e.value].auth_user=r,type:"textarea",rows:3,placeholder:"每行一个auth_user"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="domain_regex"?(s(),i(d,{key:19,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].domain_regex,"onUpdate:modelValue":r=>a.form.rules[e.value].domain_regex=r,type:"textarea",rows:3,placeholder:"每行一个domain_regex"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="source_ip_cidr"?(s(),i(d,{key:20,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].source_ip_cidr,"onUpdate:modelValue":r=>a.form.rules[e.value].source_ip_cidr=r,type:"textarea",rows:3,placeholder:"每行一个source_ip_cidr"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="process_path_regex"?(s(),i(d,{key:21,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].process_path_regex,"onUpdate:modelValue":r=>a.form.rules[e.value].process_path_regex=r,type:"textarea",rows:3,placeholder:"每行一个process_path_regex"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="client"?(s(),i(d,{key:22,label:e.value},{default:u(()=>[l(V,{modelValue:a.form.rules[e.value].client,"onUpdate:modelValue":r=>a.form.rules[e.value].client=r,placeholder:"请选择client"},{default:u(()=>[l(t,{label:"chromium",value:"chromium"}),l(t,{label:"safari",value:"safari"}),l(t,{label:"firefox",value:"firefox"}),l(t,{label:"quic-go",value:"quic-go"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="rule_set_ip_cidr_match_source"?(s(),i(d,{key:23,label:e.value},{default:u(()=>[l(U,{modelValue:a.form.rules[e.value].rule_set_ip_cidr_match_source,"onUpdate:modelValue":r=>a.form.rules[e.value].rule_set_ip_cidr_match_source=r,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="network"?(s(),i(d,{key:24,label:e.value},{default:u(()=>[l(V,{modelValue:a.form.rules[e.value].network,"onUpdate:modelValue":r=>a.form.rules[e.value].network=r,placeholder:"请选择network"},{default:u(()=>[l(t,{label:"tcp",value:"tcp"}),l(t,{label:"udp",value:"udp"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="network_type"?(s(),i(d,{key:25,label:e.value},{default:u(()=>[l(V,{modelValue:a.form.rules[e.value].network_type,"onUpdate:modelValue":r=>a.form.rules[e.value].network_type=r,placeholder:"请选择network_type"},{default:u(()=>[l(t,{label:"wifi",value:"wifi"}),l(t,{label:"cellular",value:"cellular"}),l(t,{label:"ethernet",value:"ethernet"}),l(t,{label:"other",value:"other"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="invert"?(s(),i(d,{key:26,label:e.value},{default:u(()=>[l(U,{modelValue:a.form.rules[e.value].invert,"onUpdate:modelValue":r=>a.form.rules[e.value].invert=r,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="source_ip_is_private"?(s(),i(d,{key:27,label:e.value},{default:u(()=>[l(U,{modelValue:a.form.rules[e.value].source_ip_is_private,"onUpdate:modelValue":r=>a.form.rules[e.value].source_ip_is_private=r,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="ip_is_private"?(s(),i(d,{key:28,label:e.value},{default:u(()=>[l(U,{modelValue:a.form.rules[e.value].ip_is_private,"onUpdate:modelValue":r=>a.form.rules[e.value].ip_is_private=r,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="clash_mode"?(s(),i(d,{key:29,label:e.value},{default:u(()=>[l(f,{modelValue:a.form.rules[e.value].clash_mode,"onUpdate:modelValue":r=>a.form.rules[e.value].clash_mode=r,placeholder:"请输入clash_mode"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="network_is_expensive"?(s(),i(d,{key:30,label:e.value},{default:u(()=>[l(U,{modelValue:a.form.rules[e.value].network_is_expensive,"onUpdate:modelValue":r=>a.form.rules[e.value].network_is_expensive=r,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0),e.value==="network_is_constrained"?(s(),i(d,{key:31,label:e.value},{default:u(()=>[l(U,{modelValue:a.form.rules[e.value].network_is_constrained,"onUpdate:modelValue":r=>a.form.rules[e.value].network_is_constrained=r,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):m("",!0)],64))),128))])]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","title"]),l(D,{modelValue:n.visible,"onUpdate:modelValue":o[19]||(o[19]=e=>n.visible=e),title:"添加规则集",width:"600px",class:"modern-dialog"},{footer:u(()=>[b("div",ce,[l(k,{onClick:o[18]||(o[18]=e=>n.visible=!1)},{default:u(()=>o[31]||(o[31]=[x("取消")])),_:1,__:[31]}),l(k,{type:"primary",onClick:W},{default:u(()=>o[32]||(o[32]=[x("确定")])),_:1,__:[32]})])]),default:u(()=>[b("div",fe,[l(P,{model:n.form,"label-position":"top",class:"modern-form"},{default:u(()=>[l(d,{label:"type",required:""},{default:u(()=>[l(V,{modelValue:n.form.type,"onUpdate:modelValue":o[10]||(o[10]=e=>n.form.type=e),placeholder:"请选择类型"},{default:u(()=>[l(t,{label:"inline",value:"inline"}),l(t,{label:"local",value:"local"}),l(t,{label:"remote",value:"remote"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"tag",required:""},{default:u(()=>[l(f,{modelValue:n.form.tag,"onUpdate:modelValue":o[11]||(o[11]=e=>n.form.tag=e),placeholder:"请输入tag"},null,8,["modelValue"])]),_:1}),n.form.type==="inline"?(s(),w("div",pe,[(s(!0),w(g,null,S(n.form.rules,(e,r)=>(s(),i(I,{key:r,class:"mb-2"},{default:u(()=>[b("div",_e,[b("span",null,"规则"+ee(r+1),1),l(k,{type:"danger",size:"small",onClick:_=>G(r)},{default:u(()=>o[29]||(o[29]=[x("删除")])),_:2,__:[29]},1032,["onClick"])]),l(d,{label:"type",required:""},{default:u(()=>[l(V,{modelValue:e.type,"onUpdate:modelValue":_=>e.type=_,placeholder:"请选择规则类型"},{default:u(()=>[(s(),w(g,null,S(R,_=>l(t,{key:_.value,label:_.label,value:_.value},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e.type?(s(),i(d,{key:0,label:e.type,required:""},{default:u(()=>[R.find(_=>_.value===e.type).input==="textarea"?(s(),i(f,{key:0,modelValue:e.value,"onUpdate:modelValue":_=>e.value=_,type:"textarea",rows:3,placeholder:"请输入"+e.type+"，每行一项"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):R.find(_=>_.value===e.type).input==="select"?(s(),i(V,{key:1,modelValue:e.value,"onUpdate:modelValue":_=>e.value=_,placeholder:"请选择"+e.type},{default:u(()=>[(s(!0),w(g,null,S(R.find(_=>_.value===e.type).options,_=>(s(),i(t,{key:_,label:_,value:_},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):R.find(_=>_.value===e.type).input==="switch"?(s(),i(U,{key:2,modelValue:e.value,"onUpdate:modelValue":_=>e.value=_,"active-value":"true","inactive-value":"false"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)]),_:2},1032,["label"])):m("",!0)]),_:2},1024))),128)),l(k,{type:"primary",plain:"",icon:"el-icon-plus",onClick:L},{default:u(()=>o[30]||(o[30]=[x("添加规则")])),_:1,__:[30]})])):m("",!0),n.form.type==="local"?(s(),w(g,{key:1},[l(d,{label:"format",required:""},{default:u(()=>[l(V,{modelValue:n.form.format,"onUpdate:modelValue":o[12]||(o[12]=e=>n.form.format=e),placeholder:"请选择format"},{default:u(()=>[l(t,{label:"source",value:"source"}),l(t,{label:"binary",value:"binary"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"path",required:""},{default:u(()=>[l(f,{modelValue:n.form.path,"onUpdate:modelValue":o[13]||(o[13]=e=>n.form.path=e),placeholder:"请输入path"},null,8,["modelValue"])]),_:1})],64)):m("",!0),n.form.type==="remote"?(s(),w(g,{key:2},[l(d,{label:"format",required:""},{default:u(()=>[l(V,{modelValue:n.form.format,"onUpdate:modelValue":o[14]||(o[14]=e=>n.form.format=e),placeholder:"请选择format"},{default:u(()=>[l(t,{label:"source",value:"source"}),l(t,{label:"binary",value:"binary"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"url",required:""},{default:u(()=>[l(f,{modelValue:n.form.url,"onUpdate:modelValue":o[15]||(o[15]=e=>n.form.url=e),placeholder:"请输入url"},null,8,["modelValue"])]),_:1}),l(d,{label:"download_detour"},{default:u(()=>[l(V,{modelValue:n.form.download_detour,"onUpdate:modelValue":o[16]||(o[16]=e=>n.form.download_detour=e),placeholder:"请选择download_detour"},{default:u(()=>[(s(!0),w(g,null,S(B.value,e=>(s(),i(t,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"update_interval"},{default:u(()=>[l(f,{modelValue:n.form.update_interval,"onUpdate:modelValue":o[17]||(o[17]=e=>n.form.update_interval=e),placeholder:"请输入update_interval"},null,8,["modelValue"])]),_:1})],64)):m("",!0)]),_:1},8,["model"])])]),_:1},8,["modelValue"])])]),_:1})}}},Ue=oe(be,[["__scopeId","data-v-7fa08f9f"]]);export{Ue as default};
