import{P as k}from"./PageContainer-2AeyfqXh.js";import{r as v,k as x,m as S,n as C,o as P,w as n,f as c,b as r,e as t,p as u,t as I,i as f,q as T,v as j,s as B,x as O,E as l}from"./index-CTVkQrMm.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"dashboard"},N={class:"status-content"},V={class:"status-info"},M={class:"status-actions"},$={__name:"Dashboard",setup(q){const s=v(!1),o=v(!1);let p=null;const _=async()=>{try{const a=await fetch("/api/singbox/status");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const e=await a.json();s.value=e.status==="running"}catch(a){console.error("获取服务状态失败:",a),s.value=!1}},g=async()=>{if(!o.value){o.value=!0;try{const a=await fetch("/api/singbox/start",{method:"POST"}),e=await a.json();a.ok?(l.success(e.message||"服务启动成功"),s.value=e.status==="running"):(l.error(e.message||"服务启动失败"),s.value=!1)}catch(a){console.error("启动服务失败:",a),l.error("启动服务失败，请检查后端日志"),s.value=!1}finally{o.value=!1}}},m=async()=>{if(!o.value){o.value=!0;try{const a=await fetch("/api/singbox/stop",{method:"POST"}),e=await a.json();a.ok?(l.success(e.message||"服务停止成功"),s.value=e.status==="running"):l.error(e.message||"服务停止失败")}catch(a){console.error("停止服务失败:",a),l.error("停止服务失败，请检查后端日志")}finally{o.value=!1}}},b=async()=>{if(!o.value){o.value=!0;try{const a=await fetch("/api/singbox/restart",{method:"POST"}),e=await a.json();a.ok?(l.success(e.message||"服务重启成功"),s.value=e.status==="running"):(l.error(e.message||"服务重启失败"),s.value=!1)}catch(a){console.error("重启服务失败:",a),l.error("重启服务失败，请检查后端日志"),s.value=!1}finally{o.value=!1}}},y=()=>{const e=`http://${window.location.hostname}:9090/ui/`;window.open(e,"_blank")};return x(()=>{_(),p=setInterval(_,5e3)}),S(()=>{p&&clearInterval(p)}),(a,e)=>{const h=c("el-tag"),i=c("el-icon"),d=c("el-button"),w=c("el-card");return P(),C(k,null,{default:n(()=>[r("div",E,[e[5]||(e[5]=r("h2",{class:"page-title"},"仪表盘",-1)),e[6]||(e[6]=r("p",{class:"page-description"},"管理和监控您的 Sing-box 代理服务状态",-1)),t(w,{class:"status-card"},{header:n(()=>e[0]||(e[0]=[r("div",{class:"card-header"},[r("span",null,"Sing-box 服务状态")],-1)])),default:n(()=>[r("div",N,[r("div",V,[t(h,{type:s.value?"success":"danger",class:"status-tag"},{default:n(()=>[u(I(s.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),r("div",M,[t(d,{type:"primary",loading:o.value,onClick:g,disabled:s.value},{default:n(()=>[t(i,null,{default:n(()=>[t(f(T))]),_:1}),e[1]||(e[1]=u(" 立即运行 "))]),_:1,__:[1]},8,["loading","disabled"]),t(d,{type:"danger",loading:o.value,onClick:m,disabled:!s.value},{default:n(()=>[t(i,null,{default:n(()=>[t(f(j))]),_:1}),e[2]||(e[2]=u(" 停止服务 "))]),_:1,__:[2]},8,["loading","disabled"]),t(d,{type:"warning",loading:o.value,onClick:b,disabled:!s.value},{default:n(()=>[t(i,null,{default:n(()=>[t(f(B))]),_:1}),e[3]||(e[3]=u(" 重启服务 "))]),_:1,__:[3]},8,["loading","disabled"]),t(d,{type:"success",onClick:y,disabled:!s.value},{default:n(()=>[t(i,null,{default:n(()=>[t(f(O))]),_:1}),e[4]||(e[4]=u(" 打开面板 "))]),_:1,__:[4]},8,["disabled"])])])]),_:1})])]),_:1})}}},U=D($,[["__scopeId","data-v-89db244a"]]);export{U as default};
