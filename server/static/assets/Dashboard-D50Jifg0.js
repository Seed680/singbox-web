import{_ as y,P as x}from"./PageContainer-V0UEeMgc.js";import{r as v,o as k,a as S,c as C,b as I,w as o,d as u,e as l,f as t,g as i,t as P,u as f,h as T,v as B,i as j,E as r}from"./index-CP9QC06r.js";const D={class:"dashboard"},E={class:"status-content"},N={class:"status-info"},O={class:"status-actions"},V={__name:"Dashboard",setup(M){const s=v(!1),n=v(!1);let d=null;const p=async()=>{try{const a=await fetch("/api/singbox/status");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const e=await a.json();s.value=e.status==="running"}catch(a){console.error("获取服务状态失败:",a),s.value=!1}},g=async()=>{if(!n.value){n.value=!0;try{const a=await fetch("/api/singbox/start",{method:"POST"}),e=await a.json();a.ok?(r.success(e.message||"服务启动成功"),s.value=e.status==="running"):(r.error(e.message||"服务启动失败"),s.value=!1)}catch(a){console.error("启动服务失败:",a),r.error("启动服务失败，请检查后端日志"),s.value=!1}finally{n.value=!1}}},m=async()=>{if(!n.value){n.value=!0;try{const a=await fetch("/api/singbox/stop",{method:"POST"}),e=await a.json();a.ok?(r.success(e.message||"服务停止成功"),s.value=e.status==="running"):r.error(e.message||"服务停止失败")}catch(a){console.error("停止服务失败:",a),r.error("停止服务失败，请检查后端日志")}finally{n.value=!1}}},b=()=>{const e=`http://${window.location.hostname}:9090/ui/`;window.open(e,"_blank")};return k(()=>{p(),d=setInterval(p,5e3)}),S(()=>{d&&clearInterval(d)}),(a,e)=>{const h=u("el-tag"),c=u("el-icon"),_=u("el-button"),w=u("el-card");return I(),C(x,null,{default:o(()=>[l("div",D,[e[4]||(e[4]=l("h2",{class:"page-title"},"仪表盘",-1)),e[5]||(e[5]=l("p",{class:"page-description"},"管理和监控您的 Sing-box 代理服务状态",-1)),t(w,{class:"status-card"},{header:o(()=>e[0]||(e[0]=[l("div",{class:"card-header"},[l("span",null,"Sing-box 服务状态")],-1)])),default:o(()=>[l("div",E,[l("div",N,[t(h,{type:s.value?"success":"danger",class:"status-tag"},{default:o(()=>[i(P(s.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),l("div",O,[t(_,{type:"primary",loading:n.value,onClick:g,disabled:s.value},{default:o(()=>[t(c,null,{default:o(()=>[t(f(T))]),_:1}),e[1]||(e[1]=i(" 立即运行 "))]),_:1,__:[1]},8,["loading","disabled"]),t(_,{type:"danger",loading:n.value,onClick:m,disabled:!s.value},{default:o(()=>[t(c,null,{default:o(()=>[t(f(B))]),_:1}),e[2]||(e[2]=i(" 停止服务 "))]),_:1,__:[2]},8,["loading","disabled"]),t(_,{type:"success",onClick:b,disabled:!s.value},{default:o(()=>[t(c,null,{default:o(()=>[t(f(j))]),_:1}),e[3]||(e[3]=i(" 打开面板 "))]),_:1,__:[3]},8,["disabled"])])])]),_:1})])]),_:1})}}},L=y(V,[["__scopeId","data-v-7bf4504c"]]);export{L as default};
