import{_ as m,P as y}from"./PageContainer-tPvqN9FT.js";import{r as f,o as h,a as w,c as x,b as S,w as o,d,e as t,f as c,g as u,t as C,E as n}from"./index-BZk_pjB3.js";const k={class:"dashboard"},B={class:"status-content"},I={class:"status-info"},P={class:"status-actions"},j={__name:"Dashboard",setup(D){const r=f(!1),a=f(!1);let i=null;const l=async()=>{try{const s=await(await fetch("/api/singbox/status")).json();s.success&&(r.value=s.running)}catch(e){console.error("获取服务状态失败:",e)}},_=async()=>{if(!a.value){a.value=!0;try{const s=await(await fetch("/api/singbox/start",{method:"POST"})).json();s.success?(n.success("服务启动成功"),await l()):n.error(s.error||"服务启动失败")}catch(e){console.error("启动服务失败:",e),n.error("启动服务失败")}finally{a.value=!1}}},v=async()=>{if(!a.value){a.value=!0;try{const s=await(await fetch("/api/singbox/stop",{method:"POST"})).json();s.success?(n.success("服务停止成功"),await l()):n.error(s.error||"服务停止失败")}catch(e){console.error("停止服务失败:",e),n.error("停止服务失败")}finally{a.value=!1}}};return h(()=>{l(),i=setInterval(l,5e3)}),w(()=>{i&&clearInterval(i)}),(e,s)=>{const g=d("el-tag"),p=d("el-button"),b=d("el-card");return S(),x(y,null,{default:o(()=>[t("div",k,[s[3]||(s[3]=t("h2",{class:"page-title"},"仪表盘",-1)),s[4]||(s[4]=t("p",{class:"page-description"},"管理和监控您的 Sing-box 代理服务状态",-1)),c(b,{class:"status-card"},{header:o(()=>s[0]||(s[0]=[t("div",{class:"card-header"},[t("span",null,"Sing-box 服务状态")],-1)])),default:o(()=>[t("div",B,[t("div",I,[c(g,{type:r.value?"success":"danger",class:"status-tag"},{default:o(()=>[u(C(r.value?"运行中":"已停止"),1)]),_:1},8,["type"])]),t("div",P,[c(p,{type:"primary",loading:a.value,onClick:_,disabled:r.value},{default:o(()=>s[1]||(s[1]=[u(" 立即运行 ")])),_:1,__:[1]},8,["loading","disabled"]),c(p,{type:"danger",loading:a.value,onClick:v,disabled:!r.value},{default:o(()=>s[2]||(s[2]=[u(" 停止服务 ")])),_:1,__:[2]},8,["loading","disabled"])])])]),_:1})])]),_:1})}}},V=m(j,[["__scopeId","data-v-32f75461"]]);export{V as default};
