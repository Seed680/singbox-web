import{r as d,o as h,a as y,c as w,b as E,w as i,E as t,d as u,m as B,e as a,f as l,g as S,u as x,j as I,t as k,n as C}from"./index-D0h7X9x_.js";import{_ as N,P as J}from"./PageContainer-BIDKZJWI.js";import{J as O}from"./jsoneditor-DKimo5TI.js";const P={class:"inbound"},j={class:"page-header"},T={id:"inboundEditor",style:{width:"100%",height:"500px"}},f="/api",D={__name:"Inbound",setup(M){const n=d(null),s=d(!1),c=d(!1),_=()=>{const e=document.getElementById("inboundEditor"),o={mode:"code",modes:["code","tree","view","form","text"],onError:function(r){t.error("JSON 格式错误："+r.toString())},mainMenuBar:!0,navigationBar:!1,statusBar:!0,colorPicker:!1,search:!0,format:!0,repair:!0};n.value=new O(e,o)},p=async()=>{try{c.value=!0;const e=await fetch(`${f}/inbounds`);if(e.ok){const o=await e.json();n.value&&n.value.set(o.inbounds||[])}else t.error("加载入站配置失败")}catch(e){console.error("加载入站配置失败:",e),t.error("加载入站配置失败，请检查后端服务是否启动")}finally{c.value=!1}},v=async()=>{try{s.value=!0;const e=n.value.get(),o=await fetch(`${f}/inbounds`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inbounds:e})});if(o.ok)t.success("入站配置保存成功");else{const r=await o.json();t.error(r.error||"入站配置保存失败")}}catch(e){console.error("保存入站配置失败:",e),t.error("保存失败，请检查JSON格式是否正确")}finally{s.value=!1}};return h(()=>{_(),setTimeout(()=>{p()},100)}),y(()=>{n.value&&n.value.destroy()}),(e,o)=>{const r=u("el-icon"),m=u("el-button"),g=u("el-card"),b=B("loading");return E(),w(J,null,{default:i(()=>[a("div",P,[a("div",j,[o[0]||(o[0]=a("h2",{class:"page-title"},"入站配置",-1)),l(m,{type:"primary",onClick:v,loading:s.value},{default:i(()=>[l(r,null,{default:i(()=>[l(x(I))]),_:1}),S(" "+k(s.value?"保存中...":"保存"),1)]),_:1},8,["loading"])]),l(g,{class:"box-card"},{header:i(()=>o[1]||(o[1]=[a("div",{class:"card-header"},[a("span",null,"入站配置")],-1)])),default:i(()=>[C(a("div",T,null,512),[[b,s.value||c.value]])]),_:1})])]),_:1})}}},L=N(D,[["__scopeId","data-v-a2f99031"]]);export{L as default};
