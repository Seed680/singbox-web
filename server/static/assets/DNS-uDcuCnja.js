import{r as d,o as N,a as h,c as D,b as y,w as l,E as a,d as u,q as w,e as s,f as i,g as E,u as B,m as x,t as k,s as C}from"./index-CP9QC06r.js";import{_ as b,P as J}from"./PageContainer-V0UEeMgc.js";import{J as O}from"./jsoneditor-BPekWwM3.js";const P={class:"dns"},T={class:"page-header"},j={id:"dnsEditor",style:{width:"100%",height:"500px"}},f="/api",I={__name:"DNS",setup(M){const t=d(null),n=d(!1),c=d(!1),_=()=>{const e=document.getElementById("dnsEditor"),o={mode:"code",modes:["code","tree","view","form","text"],onError:function(r){a.error("JSON 格式错误："+r.toString())},mainMenuBar:!0,navigationBar:!1,statusBar:!0,colorPicker:!1,search:!0,format:!0,repair:!0};t.value=new O(e,o)},p=async()=>{try{c.value=!0;const e=await fetch(`${f}/dns`);if(e.ok){const o=await e.json();t.value&&t.value.set(o.dns||{})}else a.error("加载DNS配置失败")}catch(e){console.error("加载DNS配置失败:",e),a.error("加载DNS配置失败，请检查后端服务是否启动")}finally{c.value=!1}},v=async()=>{try{n.value=!0;const e=t.value.get(),o=await fetch(`${f}/dns`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dns:e})});if(o.ok)a.success("DNS配置保存成功");else{const r=await o.json();a.error(r.error||"DNS配置保存失败")}}catch(e){console.error("保存DNS配置失败:",e),a.error("保存失败，请检查JSON格式是否正确")}finally{n.value=!1}};return N(()=>{_(),setTimeout(()=>{p()},100)}),h(()=>{t.value&&t.value.destroy()}),(e,o)=>{const r=u("el-icon"),m=u("el-button"),S=u("el-card"),g=w("loading");return y(),D(J,null,{default:l(()=>[s("div",P,[s("div",T,[o[0]||(o[0]=s("h2",{class:"page-title"},"DNS 配置",-1)),i(m,{type:"primary",onClick:v,loading:n.value},{default:l(()=>[i(r,null,{default:l(()=>[i(B(x))]),_:1}),E(" "+k(n.value?"保存中...":"保存"),1)]),_:1},8,["loading"])]),i(S,{class:"box-card"},{header:l(()=>o[1]||(o[1]=[s("div",{class:"card-header"},[s("span",null,"DNS 配置")],-1)])),default:l(()=>[C(s("div",j,null,512),[[g,n.value||c.value]])]),_:1})])]),_:1})}}},q=b(I,[["__scopeId","data-v-8613e081"]]);export{q as default};
